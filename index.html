<!doctype html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SPARK WEAR</title>
  <meta name="theme-color" content="#f1aba7" />
  <link rel="manifest" href="manifest.webmanifest?v=20260220-1934" />
  <link rel="shortcut icon" href="favicon.ico?v=20260220-1934" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16.png?v=20260220-1934" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32.png?v=20260220-1934" />
  <link rel="icon" type="image/png" sizes="192x192" href="assets/icon-192.png?v=20260220-1934" />
  <link rel="icon" type="image/png" sizes="512x512" href="assets/icon-512.png?v=20260220-1934" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icon-180.png?v=20260220-1934" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <main class="app">
    <section id="homePage" class="page active home">
      <h1 class="home-title">SPARK WEAR</h1>
      <button class="home-btn" data-open-page="closet">我的衣櫃</button>
      <button class="home-btn" data-open-page="outfit">穿搭紀錄</button>
      <div class="home-tools">
        <button id="exportDataBtn" class="mini-action" type="button">匯出資料</button>
        <button id="importDataBtn" class="mini-action" type="button">匯入資料</button>
      </div>
      <input id="importFileInput" type="file" accept="application/json,.json" class="hidden" />
    </section>

    <section id="closetPage" class="page">
      <header class="page-head">
        <h1>我的衣櫃</h1>
        <div class="head-actions">
          <button id="toggleClosetSearch" class="icon-btn" type="button" aria-label="搜尋">🔍</button>
          <button class="back-btn" data-back-home>返回</button>
        </div>
      </header>
      <div id="closetSearchBar" class="search-bar hidden">
        <div class="search-row">
          <input id="closetSearchInput" placeholder="搜尋關鍵字（品牌/名稱/介紹/分類/標籤）" />
          <button id="clearClosetSearch" type="button">清除</button>
        </div>
      </div>

      <nav class="sub-tabs">
        <button class="sub-btn active" data-sub-tab="latest">最新</button>
        <button class="sub-btn" data-sub-tab="photos">照片</button>
        <button class="sub-btn" data-sub-tab="category">分類</button>
        <button class="sub-btn" data-sub-tab="tags">標籤</button>
      </nav>

      <div class="sort-bar">
        <label>
          排序
          <select id="purchaseSortSelect">
            <option value="desc">最新到最舊</option>
            <option value="asc">最舊到最新</option>
          </select>
        </label>
      </div>

      <section id="closetLatest" class="sub-panel active"></section>

      <section id="closetPhotos" class="sub-panel"></section>

      <section id="closetCategory" class="sub-panel">
        <div class="panel-head">
          <h3 class="section-title">分類瀏覽</h3>
          <button id="openCategoryEdit" type="button" class="mini-action">✏️ 編輯類別</button>
        </div>
        <div id="categoryChips" class="chip-row"></div>
        <div id="categoryResult" class="list"></div>
      </section>

      <section id="closetTags" class="sub-panel">
        <div class="panel-head">
          <h3 class="section-title">標籤（可多選）</h3>
          <label class="mini-sort">
            使用次數
            <select id="tagUsageSortSelect">
              <option value="none">不排序</option>
              <option value="desc">最多到最少</option>
              <option value="asc">最少到最多</option>
            </select>
          </label>
        </div>
        <div id="tagChips" class="chip-row"></div>
        <div id="tagResult" class="list"></div>
      </section>

      <button id="openItemForm" class="fab" aria-label="新增衣物">✏️</button>
    </section>

    <section id="outfitPage" class="page">
      <header class="page-head">
        <h1>穿搭紀錄</h1>
        <div class="head-actions">
          <button id="toggleOutfitSearch" class="icon-btn" type="button" aria-label="搜尋">🔍</button>
          <button class="back-btn" data-back-home>返回</button>
        </div>
      </header>
      <div id="outfitSearchBar" class="search-bar hidden">
        <div class="search-row">
          <input id="outfitSearchInput" placeholder="搜尋關鍵字（天氣/氣溫/小紀錄/縣市/地點）" />
          <button id="clearOutfitSearch" type="button">清除</button>
        </div>
      </div>
      <div class="sort-bar">
        <label>
          排序
          <select id="outfitSortSelect">
            <option value="desc">最新到最舊</option>
            <option value="asc">最舊到最新</option>
          </select>
        </label>
      </div>

      <section id="outfitGrid" class="photo-grid"></section>
      <button id="openOutfitMenu" class="fab" aria-label="穿搭筆記本">✏️</button>
    </section>
  </main>

  <dialog id="itemDialog">
    <form id="itemForm" class="dialog-card" method="dialog">
      <h2 id="itemFormTitle">紀錄新品</h2>
      <div class="grid-2">
        <label>品牌名稱<input name="brand" /></label>
        <label>商品名稱<input name="name" required /></label>
        <label>購買日期<input type="date" name="purchaseDate" required /></label>
        <label>
          分類
          <select id="itemCategorySelect" name="category" required></select>
        </label>
        <label>原價<input type="number" name="originalPrice" min="0" /></label>
        <label>特價<input type="number" name="specialPrice" min="0" /></label>
        <label>優惠價<input type="number" name="discountPrice" min="0" /></label>
        <label>建議體重（kg）<input name="suggestedWeight" placeholder="例如：45-52" /></label>
        <label>
          分級
          <select name="grade">
            <option value="">未設定</option>
            <option>A</option>
            <option>B</option>
            <option>C</option>
            <option>D</option>
            <option>E</option>
          </select>
        </label>
        <label>
          來源
          <select name="origin">
            <option value="">未設定</option>
            <option>日貨</option>
            <option>韓貨</option>
            <option>品牌</option>
            <option>蝦皮</option>
            <option>淘寶</option>
            <option>其他</option>
          </select>
        </label>
      </div>

      <fieldset>
        <legend>季節</legend>
        <label><input type="checkbox" name="seasons" value="春季" />春季</label>
        <label><input type="checkbox" name="seasons" value="夏季" />夏季</label>
        <label><input type="checkbox" name="seasons" value="秋季" />秋季</label>
        <label><input type="checkbox" name="seasons" value="冬季" />冬季</label>
      </fieldset>

      <label>小紀錄<textarea name="miniNote" rows="2"></textarea></label>
      <label>優點<textarea name="pros" rows="2"></textarea></label>
      <label>缺點<textarea name="cons" rows="2"></textarea></label>
      <label>備註<textarea name="remark" rows="2"></textarea></label>
      <section id="existingItemPhotosSection" class="hidden">
        <strong>目前照片（勾選可刪除）</strong>
        <div id="existingItemPhotosList" class="existing-photos-grid"></div>
      </section>
      <label>首圖與商品照片（第一張做首圖）<input type="file" name="itemPhotos" accept="image/*" multiple /></label>

      <div class="actions">
        <button type="button" data-close-item>取消</button>
        <button type="submit">儲存</button>
      </div>
    </form>
  </dialog>

  <dialog id="outfitMenuDialog">
    <article class="dialog-card">
      <h2>穿搭筆記本</h2>
      <div class="actions single-col">
        <button id="openOutfitFormAction" type="button">新增穿搭</button>
        <button id="openVoteFormAction" type="button">票選衣服</button>
        <button id="closeOutfitMenu" type="button">取消</button>
      </div>
    </article>
  </dialog>

  <dialog id="outfitFormDialog">
    <form id="outfitForm" class="dialog-card" method="dialog">
      <h2 id="outfitFormTitle">新增穿搭</h2>
      <div class="grid-2">
        <label>日期<input type="date" name="date" required /></label>
        <label>天氣<input name="weather" placeholder="例如：24°C 陰" /></label>
      </div>
      <div class="grid-2">
        <label>縣市<input name="county" placeholder="例如：台北市" /></label>
        <label>地點<input name="place" placeholder="例如：信義區" /></label>
      </div>
      <label>氣溫<input name="temperature" placeholder="例如：24°C" /></label>
      <label>穿搭想法<textarea name="note" rows="3"></textarea></label>
      <label>穿搭照片（1~20 張，第一張主圖）<input type="file" name="outfitPhotos" accept="image/*" multiple /></label>
      <div>
        <strong>搭配單品（可多選）</strong>
        <div class="grid-2">
          <label>搜尋品牌<input id="outfitSearchBrand" name="outfitSearchBrand" placeholder="輸入品牌" /></label>
          <label>搜尋名稱<input id="outfitSearchName" name="outfitSearchName" placeholder="輸入名稱" /></label>
          <label>搜尋標籤<input id="outfitSearchTag" name="outfitSearchTag" placeholder="例如：春季、韓貨" /></label>
          <label>分類<select id="outfitSearchCategory" name="outfitSearchCategory"></select></label>
        </div>
        <div id="outfitItemChecklist" class="list"></div>
      </div>
      <div class="actions">
        <button type="button" data-close-outfit>取消</button>
        <button type="submit">儲存</button>
      </div>
    </form>
  </dialog>

  <dialog id="voteDialog">
    <form id="voteForm" class="dialog-card" method="dialog">
      <h2>票選衣服</h2>
      <div class="grid-2">
        <label>搜尋品牌<input id="voteSearchBrand" name="searchBrand" placeholder="輸入品牌" /></label>
        <label>搜尋名稱<input id="voteSearchName" name="searchName" placeholder="輸入商品名稱" /></label>
        <label>搜尋標籤<input id="voteSearchTag" name="searchTag" placeholder="例如：春季、日貨" /></label>
        <label>
          分類
          <select id="voteSearchCategory" name="searchCategory"></select>
        </label>
      </div>
      <div>
        <strong>搜尋結果</strong>
        <div id="voteManualChecklist" class="list"></div>
      </div>
      <div class="actions">
        <button type="button" id="closeVoteDialog">取消</button>
        <button type="submit">確認投票</button>
      </div>
    </form>
  </dialog>

  <dialog id="outfitDetailDialog">
    <article class="dialog-card">
      <div class="detail-top-actions">
        <button id="editOutfitDetail" class="secondary-btn" type="button">編輯</button>
        <button id="deleteOutfitDetail" class="danger-btn" type="button">刪除</button>
        <button id="closeDetail" class="close-btn" type="button">關閉</button>
      </div>
      <h2 id="detailDate"></h2>
      <section class="carousel">
        <button id="outfitDetailPrev" class="carousel-btn" type="button" aria-label="上一張">◀</button>
        <img id="outfitDetailMainPhoto" class="detail-photo" alt="穿搭照片" />
        <button id="outfitDetailNext" class="carousel-btn" type="button" aria-label="下一張">▶</button>
      </section>
      <p id="outfitDetailCounter" class="meta"></p>
      <section class="detail-records">
        <div id="detailMeta"></div>
        <div id="detailTemp"></div>
        <div id="detailNote"></div>
        <div id="detailItems"></div>
      </section>
    </article>
  </dialog>

  <section id="categoryItemsPage" class="overlay-page">
    <header class="page-head">
      <h1 id="categoryItemsTitle">分類</h1>
      <button id="closeCategoryItemsPage" class="back-btn" type="button">關閉</button>
    </header>
    <nav class="sub-tabs category-inner-tabs">
      <button id="categoryItemsLatestTab" class="sub-btn active" type="button">最新</button>
      <button id="categoryItemsPhotosTab" class="sub-btn" type="button">照片</button>
    </nav>
    <section id="categoryItemsList" class="list"></section>
  </section>

  <dialog id="itemDetailDialog">
    <article class="dialog-card">
      <div class="detail-top-actions">
        <button id="editItemDetail" class="secondary-btn" type="button">編輯</button>
        <button id="deleteItemDetail" class="danger-btn" type="button">刪除</button>
        <button id="closeItemDetail" class="close-btn" type="button">關閉</button>
      </div>
      <h2 id="itemDetailTitle"></h2>
      <section class="carousel">
        <button id="itemDetailPrev" class="carousel-btn" type="button" aria-label="上一張">◀</button>
        <img id="itemDetailMainPhoto" class="detail-photo" alt="商品照片" />
        <button id="itemDetailNext" class="carousel-btn" type="button" aria-label="下一張">▶</button>
      </section>
      <p id="itemDetailCounter" class="meta"></p>
      <section id="itemDetailRecords" class="detail-records"></section>
      <section id="itemUsedOutfits" class="detail-records"></section>
    </article>
  </dialog>

  <dialog id="categoryEditDialog">
    <form id="categoryEditForm" class="dialog-card" method="dialog">
      <h2>編輯類別</h2>
      <div id="categoryEditRows" class="list"></div>
      <section class="add-category-row">
        <input id="newCategoryName" placeholder="新增類別名稱" />
        <input id="newCategoryColor" type="color" value="#888888" />
        <button id="addCategoryBtn" type="button">新增</button>
      </section>
      <div class="actions">
        <button type="button" id="closeCategoryEdit">取消</button>
        <button type="submit">儲存設定</button>
      </div>
    </form>
  </dialog>

  <dialog id="confirmDeleteItemDialog">
    <article class="dialog-card">
      <h2>確認刪除單品</h2>
      <p id="confirmDeleteItemText">確定要刪除這件單品嗎？</p>
      <div class="actions">
        <button id="cancelDeleteItem" type="button">取消</button>
        <button id="confirmDeleteItem" class="danger-btn" type="button">確認</button>
      </div>
    </article>
  </dialog>

  <dialog id="confirmDeleteOutfitDialog">
    <article class="dialog-card">
      <h2>確認刪除穿搭</h2>
      <p id="confirmDeleteOutfitText">確定要刪除這筆穿搭嗎？</p>
      <div class="actions">
        <button id="cancelDeleteOutfit" type="button">取消</button>
        <button id="confirmDeleteOutfit" class="danger-btn" type="button">確認</button>
      </div>
    </article>
  </dialog>

  <dialog id="importModeDialog">
    <article class="dialog-card">
      <h2>匯入資料</h2>
      <p>請選擇匯入方式：</p>
      <div class="actions single-col">
        <button id="importMergeBtn" type="button">合併匯入</button>
        <button id="importReplaceBtn" type="button">覆蓋匯入</button>
        <button id="cancelImportBtn" type="button">取消</button>
      </div>
    </article>
  </dialog>

  <script src="app.js"></script>
</body>

</html>
